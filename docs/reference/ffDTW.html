<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Acoustic dissimilarity using dynamic time warping on fundamental frequency contours — ffDTW • warbleR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Acoustic dissimilarity using dynamic time warping on fundamental frequency contours — ffDTW" />

<meta property="og:description" content="ffDTW calculates acoustic dissimilarity of fundamental frequency contours using dynamic
time warping. Internally it applies the dtwDist function from the dtw package." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">warbleR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/warbleR_workflow_01.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Import sound files and select signals&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_02.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Visual inspection and signal classification&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_03.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Acoustic (dis)similarity, coordinated singing and simulating songs&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Acoustic dissimilarity using dynamic time warping on fundamental frequency contours</h1>
    
    <div class="hidden name"><code>ffDTW.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>ffDTW</code> calculates acoustic dissimilarity of fundamental frequency contours using dynamic
time warping. Internally it applies the <code><a href='http://www.rdocumentation.org/packages/dtw/topics/dtwDist'>dtwDist</a></code> function from the <code>dtw</code> package.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ffDTW</span>(<span class='no'>X</span>, <span class='kw'>wl</span> <span class='kw'>=</span> <span class='fl'>512</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>wn</span> <span class='kw'>=</span> <span class='st'>"hanning"</span>, <span class='kw'>ovlp</span> <span class='kw'>=</span> <span class='fl'>70</span>,
<span class='kw'>bp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>22</span>), <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>img</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>img.suffix</span> <span class='kw'>=</span> <span class='st'>"ffDTW"</span>, <span class='kw'>pb</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>clip.edges</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>window.type</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
<span class='kw'>open.end</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>object of class 'selection_table', 'extended_selection_table' or data frame containing columns for sound file name (sound.files), 
selection number (selec), and start and end time of signal (start and end).
The ouptut of <code><a href='manualoc.html'>manualoc</a></code> or <code><a href='autodetec.html'>autodetec</a></code> can be used as the input data frame.</p></td>
    </tr>
    <tr>
      <th>wl</th>
      <td><p>A numeric vector of length 1 specifying the window length of the spectrogram, default 
is 512.</p></td>
    </tr>
    <tr>
      <th>length.out</th>
      <td><p>A numeric vector of length 1 giving the number of measurements of fundamental 
frequency desired (the length of the time series).</p></td>
    </tr>
    <tr>
      <th>wn</th>
      <td><p>Character vector of length 1 specifying window name. Default is 
"hanning". See function <code><a href='http://www.rdocumentation.org/packages/seewave/topics/ftwindow'>ftwindow</a></code> for more options.</p></td>
    </tr>
    <tr>
      <th>ovlp</th>
      <td><p>Numeric vector of length 1 specifying % of overlap between two 
consecutive windows, as in <code><a href='http://www.rdocumentation.org/packages/seewave/topics/spectro'>spectro</a></code>. Default is 70.</p></td>
    </tr>
    <tr>
      <th>bp</th>
      <td><p>A numeric vector of length 2 for the lower and upper limits of a 
frequency bandpass filter (in kHz). Default is c(0, 22).</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>amplitude threshold (%) for fundamental frequency detection. Default is 5.</p></td>
    </tr>
    <tr>
      <th>img</th>
      <td><p>Logical argument. If <code>FALSE</code>, image files are not produced. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Numeric. Controls whether parallel computing is applied.
It specifies the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Character string containing the directory path where the sound files are located. 
If <code>NULL</code> (default) then the current working directory is used.</p></td>
    </tr>
    <tr>
      <th>img.suffix</th>
      <td><p>A character vector of length 1 with a sufix (label) to add at the end of the names of 
image files. Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>pb</th>
      <td><p>Logical argument to control progress bar. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>clip.edges</th>
      <td><p>Logical argument to control whether edges (start or end of signal) in
which amplitude values above the threshold were not detected will be removed. If 
<code>TRUE</code> (default) this edges will be excluded and signal contour will be calculated on the
remainging values. Note that DTW cannot be applied if missing values (e.i. when amplitude is not detected).</p></td>
    </tr>
    <tr>
      <th>window.type</th>
      <td><p><code><a href='http://www.rdocumentation.org/packages/dtw/topics/dtw'>dtw</a></code> windowing control parameter. Character: "none", "itakura", or a function (see <code><a href='http://www.rdocumentation.org/packages/dtw/topics/dtw'>dtw</a></code>).</p></td>
    </tr>
    <tr>
      <th>open.end</th>
      <td><p><code><a href='http://www.rdocumentation.org/packages/dtw/topics/dtw'>dtw</a></code> control parameter. Performs 
open-ended alignments (see <code><a href='http://www.rdocumentation.org/packages/dtw/topics/dtw'>dtw</a></code>).</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Logical. If <code>TRUE</code> fundamental frequency values are z-transformed using the <code><a href='http://www.rdocumentation.org/packages/base/topics/scale'>scale</a></code> function, which "ignores" differences in absolute frequencies between the signals in order to focus the 
comparison in the frequency contour, regardless of the pitch of signals. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to <code><a href='trackfreqs.html'>trackfreqs</a></code> for customizing
graphical output.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix with the pairwise dissimilarity values. If img is 
<code>FALSE</code> it also produces image files with the spectrograms of the signals listed in the 
input data frame showing the location of the fundamental frequencies.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function extracts the fundamental frequency values as a time series and
 then calculates the pairwise acoustic dissimilarity of the selections using dynamic time warping.
The function uses the <code><a href='http://www.rdocumentation.org/packages/stats/topics/approxfun'>approx</a></code> function to interpolate values between fundamental
 frequency  measures. If 'img' is  <code>TRUE</code> the function also produces image files
 with the spectrograms of the signals listed in the input data frame showing the
 location of the fundamental frequencies. Note that if no amplitude is detected at the begining or end 
 of the signals then NAs will be generated. On the other hand, if amplitude is not detected in between signal
 segments in which amplitude was detected then the values of this adjacent segments will be interpolated to fill out the missing values (e.g. no NAs in between detected amplitude segments).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M., &amp; Smith-Vidaurre, G. (2017). warbleR: An R package to streamline analysis of animal acoustic signals. Methods in Ecology and Evolution, 8(2), 184-191.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='specreator.html'>specreator</a></code> for creating spectrograms from selections,
 <code><a href='snrspecs.html'>snrspecs</a></code> for creating spectrograms to 
  optimize noise margins used in <code><a href='sig2noise.html'>sig2noise</a></code></p>
<p>dfDTW <code><a href='dfts.html'>dfts</a></code>, <code><a href='ffts.html'>ffts</a></code>, <code><a href='dfDTW.html'>dfDTW</a></code></p>
<p>Other spectrogram creators: <code><a href='color.spectro.html'>color.spectro</a></code>,
  <code><a href='dfDTW.html'>dfDTW</a></code>, <code><a href='dfts.html'>dfts</a></code>,
  <code><a href='ffts.html'>ffts</a></code>, <code><a href='multi_DTW.html'>multi_DTW</a></code>,
  <code><a href='phylo_spectro.html'>phylo_spectro</a></code>, <code><a href='snrspecs.html'>snrspecs</a></code>,
  <code><a href='sp.en.ts.html'>sp.en.ts</a></code>, <code><a href='specreator.html'>specreator</a></code>,
  <code><a href='trackfreqs.html'>trackfreqs</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>{
<span class='co'># set the temp directory</span>
<span class='co'># setwd(tempdir())</span>

<span class='co'>#load data</span>
<span class='fu'>data</span>(<span class='kw'>list</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Phae.long1"</span>, <span class='st'>"Phae.long2"</span>,<span class='st'>"lbh_selec_table"</span>))
<span class='fu'>writeWave</span>(<span class='no'>Phae.long2</span>, <span class='st'>"Phae.long2.wav"</span>) <span class='co'>#save sound files </span>
<span class='fu'>writeWave</span>(<span class='no'>Phae.long1</span>, <span class='st'>"Phae.long1.wav"</span>)

<span class='co'># run function </span>
<span class='fu'>ffDTW</span>(<span class='no'>lbh_selec_table</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,], <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>flim</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>12</span>), <span class='kw'>img</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>bp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>9</span>), <span class='kw'>wl</span> <span class='kw'>=</span> <span class='fl'>300</span>)
}</div><div class='output co'>#&gt; Creating spectrograms overlaid with fundamental frequency measurements:   |                                                  | 0 % ~calculating  </div><div class='output co'>#&gt; </div><div class='output co'>#&gt;                  Phae.long1.wav-1 Phae.long1.wav-2 Phae.long1.wav-3
#&gt; Phae.long1.wav-1            0.000           16.859           22.810
#&gt; Phae.long1.wav-2           16.859            0.000           13.009
#&gt; Phae.long1.wav-3           22.810           13.009            0.000
#&gt; Phae.long2.wav-1           17.365           84.824           35.844
#&gt;                  Phae.long2.wav-1
#&gt; Phae.long1.wav-1           17.365
#&gt; Phae.long1.wav-2           84.824
#&gt; Phae.long1.wav-3           35.844
#&gt; Phae.long2.wav-1            0.000</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Marcelo Araya-Salas (<a href='mailto:araya-salas@cornell.edu'>araya-salas@cornell.edu</a>)

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

