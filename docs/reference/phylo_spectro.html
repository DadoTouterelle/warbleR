<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add spectrograms onto phylogenetic trees — phylo_spectro • warbleR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Add spectrograms onto phylogenetic trees — phylo_spectro" />

<meta property="og:description" content="phylo_spectro Add spectrograms to the tips of an objects of class phylo." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">warbleR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/warbleR_workflow_01.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Import sound files and select signals&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_02.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Visual inspection and signal classification&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_03.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Acoustic (dis)similarity, coordinated singing and simulating songs&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add spectrograms onto phylogenetic trees</h1>
    
    <div class="hidden name"><code>phylo_spectro.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>phylo_spectro</code> Add spectrograms to the tips of an objects of class phylo.</p>
    
    </div>

    <pre class="usage"><span class='fu'>phylo_spectro</span>(<span class='no'>X</span>, <span class='no'>tree</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"fan"</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>, <span class='fl'>4</span>),
<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ladder</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>horizontal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>'selection_table', 'extended_selection_table' or data frame containing columns for sound file name 
(sound.files), selection number (selec), and start and end time of signals (start and end). 
'top.freq' and 'bottom.freq' columns are optional. In addition, the data frame must include the column 'tip.label' that contains the names of the tip labels found in the tree (e.g. '<code>tree$tip.label</code>). This column is used to match rows and tip labels. If using an 
'extended_selection_table' the sound files are not required (see <code><a href='selection_table.html'>selection_table</a></code>).</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>Object of class 'phylo' (i.e. a phylogenetic tree). Ultrametric trees may produce better results.
If <code>NULL</code> (default) then the current working directory is used. Tip labels must match the names provided in the 'tip.label' column in 'X' (see 'X' argument).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Character string of length 1 specifying the type of phylogeny to be drawn 
(as in <code><a href='http://www.rdocumentation.org/packages/ape/topics/plot.phylo'>plot.phylo</a></code>). Only 'phylogram' (default) and 'fan' are allowed.</p></td>
    </tr>
    <tr>
      <th>par.mar</th>
      <td><p>Numeric vector with 4 elements, default is <code>rep(1, 4)</code>. Specifies the number of lines 
in inner plot margins where axis labels fall, with form c(bottom, left, top, right). 
See <code><a href='http://www.rdocumentation.org/packages/graphics/topics/par'>par</a></code>. See 'inner.par' argument for controling spectrogram margins.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>Numeric vector of length 1 controlling the relative size of spectrograms. Higher numbers increase the height of spectrograms. Default is 1. 
Numbers between range <code>c(&gt;0, Inf)</code> are allowed.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Numeric vector of length 1 controlling the space between tips and spectrograms. Default is 0.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Character string containing the directory path where the sound files are located. 
If <code>NULL</code> (default) then the current working directory is used.</p></td>
    </tr>
    <tr>
      <th>ladder</th>
      <td><p>Character string controling whether the phylogeny is ladderized (i.e. the internal structure of the 
tree is reorganized to get the ladderized effect when plotted). Only 'left' of 'right' values are accepted. Default is 
<code>NULL</code> (no ladderization). See <code><a href='http://www.rdocumentation.org/packages/ape/topics/ladderize'>ladderize</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>horizontal</th>
      <td><p>Logical. Controls whether spectrograms in a fan phylogeny are place in a horizontal position 
<code>FALSE</code> or in the same angle as the tree tips. Currently only horizontal spectrograms are available.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to the internal spectrogram 
creating function (<code><a href='specreator.html'>specreator</a></code>) or phylogeny plotting function (<code><a href='http://www.rdocumentation.org/packages/ape/topics/plot.phylo'>plot.phylo</a></code>) for 
customizing graphical output. Only rightwards phylogenies can be plotted.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A phylogenetic tree with spectrograms on tree tips is plotted in the current graphical device.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function add the spectrograms of sounds annotated in a selection table ('X' argument) onto the tips of a phylogenetic tree. 
The 'tip.label' column in 'X' is used to match spectrograms and tree tips. The function uses internally the <code><a href='http://www.rdocumentation.org/packages/ape/topics/plot.phylo'>plot.phylo</a></code> function to plot the tree 
and the <code><a href='specreator.html'>specreator</a></code> function to create the spectrograms. Arguments for both of these functions
can be provided for further customization. Fitting spectrograms</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M., &amp; Smith-Vidaurre, G. (2017). warbleR: An R package to streamline analysis of animal acoustic signals. Methods in Ecology and Evolution, 8(2), 184-191.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='specreator.html'>specreator</a></code>, <code><a href='http://www.rdocumentation.org/packages/ape/topics/plot.phylo'>plot.phylo</a></code></p>
<p>Other spectrogram creators: <code><a href='color.spectro.html'>color.spectro</a></code>,
  <code><a href='dfDTW.html'>dfDTW</a></code>, <code><a href='dfts.html'>dfts</a></code>,
  <code><a href='ffDTW.html'>ffDTW</a></code>, <code><a href='ffts.html'>ffts</a></code>,
  <code><a href='multi_DTW.html'>multi_DTW</a></code>, <code><a href='snrspecs.html'>snrspecs</a></code>,
  <code><a href='sp.en.ts.html'>sp.en.ts</a></code>, <code><a href='specreator.html'>specreator</a></code>,
  <code><a href='trackfreqs.html'>trackfreqs</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>{ 
</div><div class='output co'>#&gt; <span class='error'>Error: &lt;text&gt;:3:0: unexpected end of input</span>
#&gt; <span class='error'>1: { </span>
#&gt; <span class='error'>2: </span>
#&gt; <span class='error'>  ^</span></div><div class='input'><span class='co'># First set empty folder</span>
<span class='co'># setwd(tempdir())</span>

<span class='co'># save example sound files</span>
<span class='fu'>data</span>(<span class='kw'>list</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Phae.long1"</span>, <span class='st'>"Phae.long2"</span>, <span class='st'>"Phae.long3"</span>, <span class='st'>"selec.table"</span>))
<span class='fu'>writeWave</span>(<span class='no'>Phae.long1</span>,<span class='st'>"Phae.long1.wav"</span>)
<span class='fu'>writeWave</span>(<span class='no'>Phae.long2</span>,<span class='st'>"Phae.long2.wav"</span>)
<span class='fu'>writeWave</span>(<span class='no'>Phae.long3</span>,<span class='st'>"Phae.long3.wav"</span>)

<span class='co'># set spectrogram options (can be done at the phylo_spectro() function too)</span>
<span class='fu'><a href='warbleR_options.html'>warbleR_options</a></span>(<span class='kw'>wl</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>ovlp</span> <span class='kw'>=</span> <span class='fl'>90</span>, <span class='kw'>flim</span> <span class='kw'>=</span> <span class='st'>"frange"</span>)

<span class='co'># subset example selection table</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='no'>selec.table</span>[<span class='fl'>1</span>:<span class='fl'>8</span>, ]

<span class='co'># create random tree (need ape to be installed)</span>
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>tree</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/rtree'>rtree</a></span>(<span class='fu'>nrow</span>(<span class='no'>X</span>))

<span class='co'># Force tree to be ultrametric</span>
<span class='no'>tree</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/chronoMPL'>chronoMPL</a></span>(<span class='no'>tree</span>)

<span class='co'># add tip label column to example selection table (just for the sake of the example)</span>
<span class='no'>X</span>$<span class='no'>tip.label</span> <span class='kw'>&lt;-</span> <span class='no'>tree</span>$<span class='no'>tip.label</span>

<span class='co'># print phylogram with spectros</span>
<span class='fu'>phylo_spectro</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>tree</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>8</span>), <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='phylo_spectro-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># no margin in spectrograms and showing tip labels (higher offset)</span>
<span class='fu'>phylo_spectro</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>tree</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>6</span>),
<span class='kw'>inner.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>4</span>), <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='phylo_spectro-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># print fan tree and no margin in spectrograms</span>
<span class='fu'>phylo_spectro</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>tree</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.6</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>3</span>, <span class='fl'>4</span>),
<span class='kw'>inner.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>4</span>), <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"fan"</span>, <span class='kw'>show.tip.label</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='phylo_spectro-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># changing edge color and witdh</span>
<span class='fu'>phylo_spectro</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>tree</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>3</span>, <span class='fl'>4</span>), <span class='kw'>inner.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>4</span>),
<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"fan"</span>, <span class='kw'>show.tip.label</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>edge.color</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>edge.width</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='phylo_spectro-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># plotting a tree representing cross-correlation distances </span>
<span class='no'>xcorr_mat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xcorr.html'>xcorr</a></span>(<span class='no'>X</span>, <span class='kw'>bp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>10</span>))</div><div class='output co'>#&gt; creating templates:
#&gt;    |                                                  | 0 % ~calculating     |+++++++                                           | 12% ~00s             |+++++++++++++                                     | 25% ~00s             |+++++++++++++++++++                               | 38% ~00s             |+++++++++++++++++++++++++                         | 50% ~00s             |++++++++++++++++++++++++++++++++                  | 62% ~00s             |++++++++++++++++++++++++++++++++++++++            | 75% ~00s             |++++++++++++++++++++++++++++++++++++++++++++      | 88% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed = 00s
#&gt; running cross-correlation:
#&gt;    |                                                  | 0 % ~calculating     |++++++++                                          | 14% ~03s             |+++++++++++++++                                   | 29% ~01s             |++++++++++++++++++++++                            | 43% ~01s             |+++++++++++++++++++++++++++++                     | 57% ~01s             |++++++++++++++++++++++++++++++++++++              | 71% ~00s             |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed = 02s</div><div class='input'>
<span class='no'>xc.tree</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/chronoMPL'>chronoMPL</a></span>(<span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/as.phylo'>as.phylo</a></span>(<span class='fu'>hclust</span>(<span class='fu'>as.dist</span>(<span class='fl'>1</span> - <span class='no'>xcorr_mat</span>))))

<span class='no'>X</span>$<span class='no'>tip.label</span> <span class='kw'>&lt;-</span> <span class='no'>xc.tree</span>$<span class='no'>tip.label</span>

<span class='fu'>phylo_spectro</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='no'>xc.tree</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.03</span>, <span class='kw'>par.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>3</span>, <span class='fl'>4</span>),
<span class='kw'>inner.mar</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>4</span>), <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"fan"</span>, <span class='kw'>show.tip.label</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>edge.color</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>edge.width</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='phylo_spectro-5.png' alt='' width='700' height='433' /></div><div class='input'>  </div><div class='input'>}
</div><div class='output co'>#&gt; <span class='error'>Error: &lt;text&gt;:1:1: unexpected '}'</span>
#&gt; <span class='error'>1: }</span>
#&gt; <span class='error'>    ^</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Marcelo Araya-Salas (<a href='mailto:araya-salas@cornell.edu'>araya-salas@cornell.edu</a>)

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

